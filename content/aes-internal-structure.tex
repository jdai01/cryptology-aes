\section{Internal Structure of AES}

\begin{figure}[h] % 'h' means place the figure here if possible
    \centering
    \includegraphics[width=.8\textwidth]{aes-round-function.png} % Adjust width as needed
    \caption{
        AES round function for rounds $1, 2, \dots, n_r-1$.
    }
    \label{fig:aes-round-function} % Reference this figure with \ref{fig:sample_image}
\end{figure}

Figure \ref{fig:aes-round-function} shows the graph of a single AES round. 
The 16-byte input $A_0, \dots, A_{15}$ is fed byte-wise into the S-Box in the Byte Substitution Layer (Section \ref{sec:byte-substitution}).
The 16-byte output $B_0, \dots, B_{15}$ is permutated twice in the \texttt{ShiftRows} layer and mixed by the \texttt{MixColumn} transformation, both in the Diffusion layer (Section \ref{sec:diffusion})
Finally, the 128-bit subkey $k_i$ is XORed with the immediate result in the Key Addition layer (Section \ref{sec:key-addition}).


\input{content/layer-byte-substitution.tex}

\input{content/layer-diffusion.tex}

\input{content/layer-add-round.tex}